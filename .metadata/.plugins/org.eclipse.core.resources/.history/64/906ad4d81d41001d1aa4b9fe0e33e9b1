/*
 * Libros.c
 *
 *  Created on: 30 sep. 2022
 *      Author: Facu
 */

#include "Libros.h"
#include "utn.h"

int Libro_ObtenerIdUnico(void) {
	int idAutomatico = 1;
	return idAutomatico++;
}

/**
 * @brief Funcion que imprime un solo pasajero
 * @param arrayLibro: arrayLibro de listado de pasajeros
 */
void Libro_imprimirUno(Libro arrayLibro) {
	printf("ID: %d\n",arrayLibro.id);
	printf("Titulo: %s\n",arrayLibro.titulo);
	printf("Precio: $%.2f\n",arrayLibro.precio);
	printf("Fecha de publicacion: %d/%d/%d\n",arrayLibro.fechaPublicacion.dia, arrayLibro.fechaPublicacion.mes, arrayLibro.fechaPublicacion.anio);
}

/**
 * @brief Funcion que imprime todos los libros
 * @param arrayLibro: arrayLibro de libros
 * @param size: longitud del arrayLibro
 * @return Retorna 0 caso Exito! (-1) Error!
 */
int Libro_imprimirTodos(Libro arrayLibro[], int size) {
	int rtn = -1;
	int i;

	if (arrayLibro != NULL && size > 0) {
			//ESTA TODO BIEN
			for (i = 0; i < size; i++) {
				if (arrayLibro[i].status == OCUPADO) { //Si 'estado' == OCUPADO
					Libro_imprimirUno(arrayLibro[i]);
					rtn = 0; //Ok
				}
			}
	}

	return rtn;
}

int Libro_initArrayLibro(Libro *arrayLibro,int size){
	int i;
	int retorno = -1;
	if(size > 0)
	{

		for(i=0;i<size;i++)
		{
			arrayLibro[i].status = LIBRE;

		}
		retorno = 0;
	}
	return retorno;
}

int Libro_buscarLugarLibre(Libro *arrayLibro,int size){
	int index = -1;
	int i;
	if(size > 0)
	{
		index = 0;
		for(i=0;i<size;i++)
		{
			if(arrayLibro[i].status == LIBRE)
			{
				index = i;
				break;
			}
		}

	}
	return index;
}

int Libro_addLibro(Libro *arrayLibro,int size,int indice){
	int retorno = -1;
	int i;
	Libro bufferLibro;

	if(size > 0 && indice < size && indice >= 0){
		if(utn_getDescripcion(bufferLibro.titulo, MAX_CHARS, "\nIngrese nombre del Libro: ", "\nError! Ingrese un nombre", 2) == 0){

			strncpy(bufferLibro.titulo, strlwr(bufferLibro.titulo), MAX_CHARS);
			bufferLibro.titulo[0] = toupper(bufferLibro.titulo[0]);
			for(i=0; i<size; i++){
				if(bufferLibro.titulo[i] == ' '){
					bufferLibro.titulo[i + 1] = toupper(bufferLibro.titulo[i + 1]);
				}
			}
			if( utn_getNumeroFlotante(&bufferLibro.precio, "\nIngrese precio: ", "\nError! Ingrese un numero", 10, 10000000, 2)== 0 &&
				utn_getNumero(&bufferLibro.fechaPublicacion.dia, "\nIngrese fecha de publicacion(Numerica)\nDia: ", "\nError! Ingrese un numero: ", 1, 31, 2) == 0 &&
				utn_getNumero(&bufferLibro.fechaPublicacion.mes, "\nMes: ", "\nError! Ingrese un numero: ", 1, 12, 2) == 0 &&
				utn_getNumero(&bufferLibro.fechaPublicacion.anio, "Anio: ", "\nError! Ingrese un numero: ", 1800, 2022, 2) == 0){
				bufferLibro.id = Libro_ObtenerIdUnico();
				bufferLibro.status = 1;
				arrayLibro[indice] = bufferLibro;
				Libro_imprimirUno(arrayLibro[indice]);
				retorno = 0;
			}
		}
	}
	return retorno;
}





/***Menu***/
/**
 * Imprime el menu principal
 */
void imprimirMenu(){
	printf("\n\tMenu Principal - Facundo Estigarribia\n\n"
			"1.Alta\n"
			"2.Modificacion\n"
			"3.Baja\n"
			"4.Informar\n"
			"5.Listar\n"
			"6.Salir\n\n");
}
